{% extends 'django_spire/card/title_card.html' %}

{% block card_title %}
	Collections
{% endblock %}

{% block card_button %}
    <div class="row m-0">
        <div class="col-auto">
            <input class="rounded-2 p-1 form-control" type="text"
                   placeholder="Search ..." x-model="user_search" @input.debounce.300ms="search">
        </div>
        {% if AuthController.knowledge.can_add %}
            <div class="col-auto">
                {% url 'django_spire:knowledge:collection:form:create' as create_url %}
                {% include 'django_spire/button/primary_button.html' with button_text='Add' button_href=create_url button_icon="bi bi-plus" %}
            </div>
        {% endif %}
    </div>
{% endblock %}

{% block card_title_content %}
    <div
        @click.away="hide_menu()"
        @contextmenu.prevent=""
        class="user-select-none"
        x-sort:config="{
            handle: '[x-sort\\:handle]',
            distance: 20,
            swapThreshold: 0.01
        }"
    >
        {% include 'django_spire/knowledge/collection/component/x_collection_navigation.html' %}
        {% include 'django_spire/knowledge/collection/card/context_menu_card.html' %}
        {% include 'django_spire/knowledge/entry/card/context_menu_card.html' %}

        <div class="navigation-items">
            <x-collection-navigation :data="{items: manager.collection_map, id: null}"></x-collection-navigation>
        </div>
        <div class="search-items">
            <template x-for="(item, index) in Array.from(found_items.values())" :key="index">
                <div>
                    <template x-if="item?.constructor.name === 'Collection'">
                        <div
                            x-data="{
                                collection: item
                            }"
                        >
                            {% include 'django_spire/knowledge/collection/navigation/item/collection_item.html' with hide_chevron=True %}
                        </div>
                    </template>
                    <template x-if="item?.constructor.name === 'Entry'">
                        <div
                            x-data="{
                                entry: item
                            }"
                        >
                            {% include  'django_spire/knowledge/entry/navigation/item/navigation_item.html' %}
                        </div>
                    </template>
                </div>
            </template>
        </div>
    </div>
{% endblock %}
