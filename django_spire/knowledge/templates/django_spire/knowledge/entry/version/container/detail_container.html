{% extends 'django_spire/container/container.html' %}

{% block container_title %}
    {{ entry.name }}
{% endblock %}

{% block container_button %}
    <div class="container">
        <div class="row align-items-center">
            {% if AuthController.knowledge.can_change %}
                <div
                    class="col"
                    x-data="{
                        editor_is_readonly: true,
                        handle_btn_click() {
                            if (KNOWLEDGE_ENTRY_VERSION_EDITOR?.readOnly?.isEnabled) {
                                // Do readonly stuff
                            }
                            else {
                                // Do update stuff
                            }

                            KNOWLEDGE_ENTRY_VERSION_EDITOR?.readOnly?.toggle()
                            this.editor_is_readonly = KNOWLEDGE_ENTRY_VERSION_EDITOR?.readOnly?.isEnabled
                        }
                    }"
                >
                    <div class="btn shadow-sm btn-md btn-app-primary" @click="handle_btn_click()">
                        <span x-text="editor_is_readonly ? 'Edit' : 'Update'"></span>
                    </div>
                </div>
            {% endif %}
            <div class="col">
                {% if not entry.current_version.is_published and AuthController.knowledge.can_change %}
                    {% include 'django_spire/knowledge/entry/modal/publish_confirm_modal.html' %}
                {% else %}
                    {% include 'django_spire/knowledge/entry/badge/entry_status_badge.html' with status=entry.current_version.status %}
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}

{% block container_content %}
    <div class="container">
        <div class="row px-3">
            {# Hydrated by django_spire/knowledge/entry/version/js/editor.js #}
            <div id="knowledge-entry-version-editor"></div>
        </div>
    </div>
{% endblock %}
