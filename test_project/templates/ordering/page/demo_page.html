{% extends 'django_spire/page/full_page.html' %}
{% load static %}


{% block base_head_additional_css %}
    <style>
        body {
            margin: 0;
            background: linear-gradient(to bottom, #87ceeb 0%, #87ceeb 60%, #1e90ff 60%, #1e90ff 100%);
            overflow: hidden;
            height: 100vh;
        }

        @keyframes float {
            0% {
                transform: translateY(0) rotate(0deg);
            }
            25% {
                transform: translateY(-5px) rotate(-1deg);
            }
            50% {
                transform: translateY(0) rotate(0deg);
            }
            75% {
                transform: translateY(5px) rotate(1deg);
            }
            100% {
                transform: translateY(0) rotate(0deg);
            }
        }

        .bobbing {
            display: inline-block;
            animation: float 3s ease-in-out infinite !important;
        }

        .duck {
            position: relative;
            display: inline-block;
            transition: transform 0.4s ease;
        }

        @keyframes hover-wiggle {
            0%   { transform: translateY(-10px) rotate(-5deg); }
            25%  { transform: translateY(-12px) rotate(5deg); }
            50%  { transform: translateY(-10px) rotate(-5deg); }
            75%  { transform: translateY(-12px) rotate(5deg); }
            100% { transform: translateY(-10px) rotate(-5deg); }
        }

        .duck:hover {
            animation: hover-wiggle 0.6s ease-in-out infinite !important;
        }
        .duck.bobbing:hover {
            animation: hover-wiggle 0.6s ease-in-out infinite !important;
        }

        .duck-container {
            display: inline-block;
        }

        .duck-name {
            position: absolute;
            text-align: center;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease;
            z-index:1;
        }

        .duck-container:hover .duck-name {
            opacity: 1;
        }
    </style>
{% endblock %}


{% block full_page_content %}
    <div class="row">
        <div x-data @click="dispatch_modal_view('{% url "ordering:form:form_modal_content" pk=0 %}')" class="col-auto">
            {% include 'django_spire/button/primary_button.html' with button_text='Add Duck' button_icon='bi bi-plus-lg' %}
        </div>
        <div style="margin-top: 20%" class="col-12">&nbsp;</div>
    </div>
    <div class="row"
         x-data="{
            ducks: {{ ducks }},

            async reorder_ducks({duck, order}) {
                let url = `{% url "ordering:json:reorder" pk=0 order=0 %}`.replace(/0\/0/, `${duck.id}/${order}`);

                await GlueFetchHelper.tryGlueFetch(url, {
                    successHandler: () => {
                        dispatchError('Spooky Error!');
                        dispatchInfo('Ducks were ordered');
                        dispatchWarning('Ducks like to swim around');
                        dispatchSuccess('Ducks re-ordered');
                    },
                    errorHandler: () => console.error('boo'),
                });
            }
         }"
         x-sort="await reorder_ducks({duck: $item, order: $position})"
    >
        <template x-for="duck of ducks" :key="duck.id">
            <div @click="dispatch_modal_view('{% url "ordering:form:form_modal_content" pk=0 %}'.replace(0, duck.id))" class="col-auto duck-container" x-data style="cursor: grab" x-sort:item="duck">
                <div class="duck-name" x-text="duck.name"></div>
                    {% include 'ordering/duck/duck.svg' %}
            </div>
        </template>
    </div>
{% endblock %}
